import{a as B}from"./chunk-7IBUGIAP.js";import{a as V}from"./chunk-AJKQLG5V.js";import{A as ee,B as te,G as ie,H as ne,I as re,J as oe,a as A,b as v,d as j,e as D,fa as ae,ga as le,h as q,ha as me,i as G,ia as pe,j as U,l as z,n as R,o as L,q as Y,r as H,s as $,t as J,u as K,v as Q,w as W,y as X,z as Z}from"./chunk-QIY4R243.js";import{Ab as O,Db as T,Fa as n,Ga as i,Ha as _,K as P,Kc as N,L as b,La as g,Lc as w,N as f,O as s,Oa as x,Ob as k,Qa as p,U as E,Ya as r,Za as C,_a as S,a as h,ga as l,ha as u,hb as I,jb as y,ua as c,wa as m,xb as F}from"./chunk-AZ5APJBO.js";function se(t,d){if(t&1&&(n(0,"mat-card-subtitle"),r(1),I(2,"date"),i()),t&2){let e=p();l(),S("Member since ",y(2,1,e.user.createdAt,"mediumDate"),"")}}function ue(t,d){t&1&&(n(0,"div",9),_(1,"mat-spinner",10),i())}function _e(t,d){if(t&1&&(n(0,"div",14)(1,"div",15)(2,"h3"),r(3,"Name"),i(),n(4,"p"),r(5),i()(),n(6,"div",15)(7,"h3"),r(8,"Email"),i(),n(9,"p"),r(10),i()(),n(11,"div",16)(12,"h3"),r(13,"User Type"),i(),n(14,"p"),r(15),i()()()),t&2){let e=p(2);l(5),C(e.user==null?null:e.user.name),l(5),C(e.user==null?null:e.user.email),l(5),C(e.getUserTypeName(e.user==null?null:e.user.userType))}}function ge(t,d){t&1&&(n(0,"mat-error"),r(1,"Name is required"),i())}function xe(t,d){t&1&&(n(0,"mat-error"),r(1,"Email is required"),i())}function Ce(t,d){t&1&&(n(0,"mat-error"),r(1,"Please enter a valid email address"),i())}function ve(t,d){if(t&1&&(n(0,"form",17)(1,"mat-form-field",18)(2,"mat-label"),r(3,"Name"),i(),_(4,"input",19),c(5,ge,2,0,"mat-error",3),i(),n(6,"mat-form-field",18)(7,"mat-label"),r(8,"Email"),i(),_(9,"input",20),c(10,xe,2,0,"mat-error",3)(11,Ce,2,0,"mat-error",3),i()()),t&2){let e=p(2),o,a,M;m("formGroup",e.profileForm),l(5),m("ngIf",(o=e.profileForm.get("name"))==null?null:o.hasError("required")),l(5),m("ngIf",(a=e.profileForm.get("email"))==null?null:a.hasError("required")),l(),m("ngIf",(M=e.profileForm.get("email"))==null?null:M.hasError("email"))}}function Me(t,d){if(t&1&&(n(0,"div",11),c(1,_e,16,3,"div",12)(2,ve,12,4,"form",13),i()),t&2){let e=p();l(),m("ngIf",!e.isEditing),l(),m("ngIf",e.isEditing)}}function he(t,d){if(t&1){let e=g();n(0,"button",21),x("click",function(){f(e);let a=p();return s(a.toggleEdit())}),r(1," CANCEL "),i()}if(t&2){let e=p();m("disabled",e.loading)}}function Pe(t,d){if(t&1){let e=g();n(0,"button",22),x("click",function(){f(e);let a=p();return s(a.toggleEdit())}),r(1," EDIT PROFILE "),i()}if(t&2){let e=p();m("disabled",e.loading)}}function be(t,d){if(t&1){let e=g();n(0,"button",22),x("click",function(){f(e);let a=p();return s(a.saveProfile())}),r(1," SAVE "),i()}if(t&2){let e=p();m("disabled",e.profileForm.invalid||e.loading)}}var de=(()=>{class t{fb;authService;snackBar;profileForm;user=null;loading=!1;isEditing=!1;constructor(e,o,a){this.fb=e,this.authService=o,this.snackBar=a,this.profileForm=this.fb.group({name:["",v.required],email:["",[v.required,v.email]]})}ngOnInit(){this.loading=!0,this.authService.currentUser$.subscribe(e=>{e&&(this.user=e,this.profileForm.patchValue({name:e.name||"",email:e.email||""})),this.loading=!1})}toggleEdit(){this.isEditing=!this.isEditing,!this.isEditing&&this.user&&this.profileForm.patchValue({name:this.user.name||"",email:this.user.email||""})}saveProfile(){if(this.profileForm.invalid||!this.user?._id)return;this.loading=!0;let e=h({},this.profileForm.value);this.authService.editUser(this.user._id,e).subscribe({next:o=>{this.snackBar.open("Profile updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isEditing=!1,this.loading=!1},error:o=>{this.snackBar.open("Failed to update profile","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),console.error("Error updating profile:",o),this.loading=!1}})}getUserTypeName(e){return!e||typeof e=="string"?"Standard":e.name||"Standard"}static \u0275fac=function(o){return new(o||t)(u(z),u(V),u(ae))};static \u0275cmp=P({type:t,selectors:[["app-profile"]],decls:16,vars:6,consts:[[1,"profile-container"],[1,"profile-card"],["mat-card-avatar","",1,"profile-avatar"],[4,"ngIf"],["class","loading-spinner",4,"ngIf"],["class","profile-content",4,"ngIf"],["align","end"],["mat-button","",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],[1,"loading-spinner"],["diameter","50"],[1,"profile-content"],["class","profile-info",4,"ngIf"],["class","profile-form",3,"formGroup",4,"ngIf"],[1,"profile-info"],[1,"info-group"],[1,"user-type"],[1,"profile-form",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","name","placeholder","Your name"],["matInput","","formControlName","email","placeholder","Your email","type","email"],["mat-button","",3,"disabled","click"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(o,a){o&1&&(n(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"div",2)(4,"mat-icon"),r(5,"account_circle"),i()(),n(6,"mat-card-title"),r(7,"My Profile"),i(),c(8,se,3,4,"mat-card-subtitle",3),i(),n(9,"mat-card-content"),c(10,ue,2,0,"div",4)(11,Me,3,2,"div",5),i(),n(12,"mat-card-actions",6),c(13,he,2,1,"button",7)(14,Pe,2,1,"button",8)(15,be,2,1,"button",8),i()()()),o&2&&(l(8),m("ngIf",a.user),l(2),m("ngIf",a.loading),l(),m("ngIf",!a.loading),l(2),m("ngIf",a.isEditing),l(),m("ngIf",!a.isEditing),l(),m("ngIf",a.isEditing))},dependencies:[F,q,A,j,D,G,U,L,re,ie,ee,te,H,Q,X,J,W,K,$,N,me,O],styles:[".profile-container[_ngcontent-%COMP%]{max-width:800px;margin:2rem auto;padding:0 1rem}.profile-card[_ngcontent-%COMP%]{box-shadow:0 4px 12px #0000001a;border-radius:8px}.profile-avatar[_ngcontent-%COMP%]{background-color:#007bff;display:flex;align-items:center;justify-content:center}.profile-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:40px;height:40px;width:40px}.profile-content[_ngcontent-%COMP%]{margin-top:1rem;min-height:250px}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:3rem 0}.profile-info[_ngcontent-%COMP%]   .info-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.profile-info[_ngcontent-%COMP%]   .info-group[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;color:#666;margin-bottom:.5rem}.profile-info[_ngcontent-%COMP%]   .info-group[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;color:#333;margin:0}.profile-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:1rem}.profile-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:1rem}mat-card-actions[_ngcontent-%COMP%]{padding:1rem}mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:.5rem}"]})}return t})();var ce=[{path:"",component:de,canActivate:[B]}];var Ze=(()=>{class t{static \u0275fac=function(o){return new(o||t)};static \u0275mod=b({type:t});static \u0275inj=E({imports:[T,k.forChild(ce),R,Y,oe,ne,Z,w,le,pe]})}return t})();export{Ze as ProfileModule};
